<chapter xmlns="http://docbook.org/ns/docbook"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xml:id="running" version="5.0">
<title>Calabash Ant Task</title>

<para>This chapter describes how to run <citetitle>XML
Calabash</citetitle> from the Apache Ant using the
<code>CalabashTask</code> custom task.</para>

<section xml:id="antsetup">
<title>Setting up the Ant Task</title>

<para>Setting up is as for any other custom Ant task: you need a <markup>taskdef</markup>:</para>

<programlisting>&lt;taskdef name="calabash"
	   classname="com.xmlcalabash.drivers.CalabashTask"
	   classpath="<replaceable>path/to</replaceable>/calabash.jar"/></programlisting>
</section>

<section>
<title>Description</title>
<para>Runs Calabash.  You can use this task to process:<itemizedlist>
                                    <listitem>
                                             <para>A single input file to produce a single output
                                                  file</para>
                                    </listitem>
                                    <listitem>
                                             <para>A set of input files, processed one at a time, to
                                                  produce a set of output files</para>
                                    </listitem>
                                    <listitem>
                                             <para>Multiple input files as the input to one XProc
                                                  input port processed to produce a single output
                                                  file</para>
                                    </listitem>
                                    <listitem>
                                             <para>Any of the above with additional input ports to
                                                  each of which are applied one or more input files
                                                  whose file names may be either fixed or mapped
                                                  from the name(s) of the current main input
                                                  file(s)</para>
                                    </listitem>
                                    <listitem>
                                             <para>Any of the above with additional output ports
                                                  whose file names may be either fixed or mapped
                                                  from the name(s) of the current main input
                                                  file(s)</para>
                                    </listitem>
                           </itemizedlist></para>
                  <para>You can also specify options and parameters to be used by the
                           pipeline.</para>
                  <section>
                           <title>Input and output files and filesets</title>
                           <para>In the simplest scenario, the <tag class="attribute">in</tag>
                                    attribute, if present, specifies the single input file and/or
                                    the <tag class="attribute">out</tag> attribute, if present,
                                    specifies the single output file.  The <tag class="attribute"
                                             >inport</tag> and <tag class="attribute">outport</tag>
                                    attributes specify the pipeline port to which to apply the input
                                    or from which to receive the output, respectively, though these
                                    may be omitted as stated below.</para>
                           <para>You can as well or instead specify one or more files to apply to an
                                    input port using one or more nested <tag class="element"
                                             >input</tag> elements.</para>
                           <para><tag class="element">input</tag> elements whose <tag
                                             class="attribute">port</tag> attribute value matches
                                             <tag class="attribute">inport</tag> (or whose <tag
                                             class="attribute">port</tag> attribute is omitted when
                                             <tag class="attribute">inport</tag> is omitted) are
                                    applied to the <tag class="attribute">inport</tag> port.  Those
                                             <tag class="element">input</tag> elements may contain
                                    zero or more elements selecting an Ant resource collection
                                    (i.e., <tag class="element">fileset</tag>, <tag class="element"
                                             >dirset</tag>, etc.) that may each select zero or more
                                    files.</para>
                           <para><tag class="element">input</tag> elements for ports other than the
                                             <tag class="attribute">inport</tag> port may contain
                                    either zero or more resource collection elements or an Ant
                                    mapper element (i.e., <tag class="element">mapper</tag>, <tag
                                             class="element">globmapper</tag>, etc.) that maps the
                                    current <tag class="attribute">inport</tag> file(s) name(s) to
                                    other file name(s) that are used as the input file(s) for that
                                    port.  You cannot specify both resource collections and a mapper
                                    for an input port (nor can you specify a mapper for the <tag
                                             class="attribute">inport</tag> port).</para>
                           <para>You can as well or instead specify a file to contain the output of
                                    an output port using one or more nested <tag class="element"
                                             >output</tag> elements. You cannot specify more than
                                    one <tag class="element">output</tag> element for any pipeline
                                    output.</para>
                           <para>An <tag class="element">output</tag> element whose <tag
                                             class="attribute">port</tag> attribute value matches
                                             <tag class="attribute">outport</tag> (or whose <tag
                                             class="attribute">port</tag> attribute is omitted when
                                             <tag class="attribute">outport</tag> is omitted) is
                                    used for the <tag class="attribute">outport</tag> port. This
                                             <tag class="element">output</tag> element and the <tag
                                             class="attribute">out</tag> attribute cannot both be
                                    used at once.</para>
                           <para>Other <tag class="element">output</tag> elements may each be used
                                    for any of the other output ports of the pipeline.</para>
                           <para><tag class="attribute">output</tag> elements may contain either
                                    zero or more resource collection elements or an Ant mapper
                                    element (i.e., <tag class="element">mapper</tag>, <tag
                                             class="element">globmapper</tag>, etc.) that maps the
                                    current <tag class="attribute">inport</tag> file(s) name(s) to a
                                    file name that is used as the output file for that port.  You
                                    cannot specify both resource collections and a mapper for an
                                    output port, and the <tag class="element">output</tag> cannot
                                    result in more than one file name.</para>
                           <para>When no files are specified for either the <tag class="attribute"
                                             >inport</tag> or <tag class="attribute">outport</tag>
                                    ports, the implicit fileset (formed based on <tag
                                             class="attribute">includes</tag> and other attributes
                                    of <tag class="element">calabash</tag>) and/or an explicit file
                                    set (formed from nested resource collection elements (outside of
                                    any in <tag class="element">input</tag> or <tag class="element"
                                             >output</tag> elements)) makes a set of files that are
                                    processed one at a time as the input to the <tag
                                             class="attribute">inport</tag> port in separate runs of
                                    the pipeline.</para>
                           <para>The <tag class="attribute">basedir</tag>, <tag class="attribute"
                                             >includes</tag>, <tag class="attribute"
                                             >includesfile</tag>, <tag class="attribute"
                                             >excludes</tag>, <tag class="attribute"
                                             >excludesfile</tag>, <tag class="attribute"
                                             >defaultexcludes</tag>, and <tag class="attribute"
                                             >scanincludeddirectories</tag> attributes determine the
                                    implicit fileset.  <tag class="attribute"
                                             >useimplicitfileset</tag> can disable the implicit
                                    fileset.</para>
                           <para>When the implicit fileset and/or the explicit fileset selects one
                                    or more files, the <tag class="attribute">destdir</tag>, and
                                             <tag class="attribute">extension</tag> attributes (or
                                    using a nested mapper instead of <tag class="attribute"
                                             >extension</tag>) determine the filename to use for the
                                    output of the <tag class="attribute">outport</tag> port, and the
                                    resource collections or mapper for other input and output ports
                                    determine the file(s) from which to read or the file to which to
                                    write for those ports.</para>
                  </section>
                  <section>
                           <title>Ports</title>
                           <para>The <tag class="attribute">inport</tag> and <tag class="attribute"
                                             >outport</tag> attributes determine the pipeline ports
                                    to use for single, or sequential, processing of files.
                                    Additionally, the filename of the file on the <tag
                                             class="attribute">inport</tag> port is used (or can be
                                    used) by mappers to determine the input or output files to use
                                    for other ports.</para>
                           <para>You may omit at most one input port name and at most one output
                                    port name from the ports specified on the <tag class="element"
                                             >calabash</tag> task. The <tag class="element"
                                             >calabash</tag> task maps the first input and output
                                    ports of the pipeline that have no defined mapping to the
                                    unnamed ports (and any additional port without a defined mapping
                                    will cause an error). The omitted ports do not have to be the
                                             <tag class="attribute">inport</tag> and <tag
                                             class="attribute">outport</tag> ports; e.g., you can
                                    instead specify <tag class="attribute">inport</tag> and omit the
                                             <tag class="attribute">port</tag> attribute on the
                                    nested <tag class="element">input</tag> element for a different
                                    port. The omitted ports do not have to be the primary input and
                                    output ports of the pipeline: matching is purely by name only
                                    (or, rather, on the absence of a name).</para>
                           <para>Nested <tag class="element">parameter</tag> elements specify Inputs
                                    to parameter ports.</para>
                  </section>
</section>

<section>
<title>Parameters</title>
                  <informaltable frame="border">
                           <thead>
                                    <tr>
                                             <th>Attribute</th>
                                             <th>Description</th>
                                             <th>Required</th>
                                    </tr>
                           </thead>
                           <tbody>
                                    <tr>
                                             <td>in</td>
                                             <td>Location of a single XML file to process</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>inport</td>
                                             <td>Pipeline input port ot which to apply
                                                      <tag class="attribute">in</tag> file (or to apply files from
                                                  implicit or explicit filesets)</td>
                                             <td>No; the otherwise unmapped input port will be
                                                  used</td>
                                    </tr>
                                    <tr>
                                             <td>out</td>
                                             <td>Specifies the output name for the result of the
                                                  pipeline</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>outport</td>
                                             <td>Pipeline output port that writes to out (or to
                                                  outputs mapped from implicit and/or explicit input
                                                  filesets)</td>
                                             <td>No; the otherwise unmapped output port will be
                                                  used</td>
                                    </tr>
                                    <tr>
                                             <td>pipeline</td>
                                             <td>XProc pipeline file</td>
                                             <td>Yes, unless a nested <tag class="element">pipeline</tag> has
                                                  been specified</td>
                                    </tr>
                                    <tr>
                                             <td>useimplicitfileset</td>
                                             <td>Whether to use the implicit fileset formed using
                                                  includes, excludes, etc.</td>
                                             <td>No; default is <literal>true</literal> unless
                                                      <tag class="attribute">in</tag> or a nested
                                                  <tag class="element">input</tag> corresponding to
                                                      <markup>inport</markup> or <tag class="attribute">out</tag> or
                                                  a nested <tag class="element">output</tag> corresponding to
                                                  <markup>outport</markup> has been specified</td>
                                    </tr>
                                    <tr>
                                             <td>basedir</td>
                                             <td>Where to find the source XML when the implicit
                                                  fileset is used</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>destdir</td>
                                             <td>Where to store the results when the implicit
                                                  fileset is used</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>extension</td>
                                             <td>Desired file extension to use for outputs mapped
                                                  from the implicit and/or explicit filesets</td>
                                             <td>No; default is <literal>-out.xml</literal></td>
                                    </tr>
                                    <tr>
                                             <td>includes</td>
                                             <td>Comma- or space-separated list of patterns of files
                                                  that must be included. All files are included when
                                                  omitted. </td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>includesfile</td>
                                             <td>Name of a file, each line of which is taken as an
                                                  include pattern</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>excludes</td>
                                             <td>Comma- or space-separated list of patterns of files
                                                  that must be excluded.  No files (except default
                                                  excludes) are excluded when omtted.</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>excludesfile</td>
                                             <td>Name of a file, each line of which is taken as an
                                                  exclude pattern</td>
                                             <td>No</td>
                                    </tr>
                                    <tr>
                                             <td>defaultexcludes</td>
                                             <td>Indicates whether default excludes should be used
                                                  or not.  Default excludes are used when
                                                  omitted.</td>
                                             <td>No; default is <literal>true</literal></td>
                                    </tr>
                                    <tr>
                                             <td>scanincludeddirectories</td>
                                             <td>If any directories are matched by the
                                                  includes/excludes patterns, try to process all
                                                  files in those directories</td>
                                             <td>No; default is <literal>true</literal></td>
                                    </tr>
                                    <tr>
                                             <td>failonnoresources</td>
                                             <td>Whether the build should fail if the explicit
                                                  fileset from a nested resource collection is
                                                  empty</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>force</td>
                                             <td>Run pipeline, even when outputs are newer than
                                                  either inputs or pipeline.</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>failonerror</td>
                                             <td>Whether the build should fail if any errors
                                                  occur</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>debug</td>
                                             <td>Whether to enable debugging output from
                                                  Calabash</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>generalvalues</td>
                                             <td>Whether to enable general values.  See <uri
                                                  xlink:href="extensions.html#ext.general-values"
                                                  >http://xmlcalabash.com/docs/reference/extensions.html#ext.general-values</uri></td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>xpointerontext</td>
                                             <td>Whether XPointer attributes on an XInclude element
                                                  can be used when
                                                  <markup>parse="text"</markup></td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>usexslt10</td>
                                             <td>Whether to enable the use of XSLT 1.0</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>transparentjson</td>
                                             <td>Whether ot automatically translate between JSON and
                                                  XML</td>
                                             <td>No; default is <literal>false</literal></td>
                                    </tr>
                                    <tr>
                                             <td>jsonflavor</td>
                                             <td>Desired XML flavor</td>
                                             <td>No</td>
                                    </tr>
                           </tbody>
                  </informaltable>
</section>
         <section>
                  <title>Parameters specified as nested elements</title>
                  <section>
                           <title>input</title>
                           <para>Specification of resources to apply to an input port.  May specify
                                    additional or alternative inputs to be applied to the
                                    <tag class="attribute">inport</tag> port or may be fixed or mapped
                                    resources to be applied to other ports.</para>
                           <section>
                                    <title>Parameters</title>
                                    <informaltable frame="border">
                                             <thead>
                                                      <tr>
                                                               <th>Attribute</th>
                                                               <th>Description</th>
                                                               <th>Required</th>
                                                      </tr>
                                             </thead>
                                             <tbody>
                                                      <tr>
                                                               <td>port</td>
                                                               <td>port name</td>
                                                               <td>No; the otherwise unmapped input
                                                                        port will be used</td>
                                                      </tr>
                                                      <tr>
                                                               <td>if</td>
                                                               <td>The port specification will be used if this
                                                                        property is set</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>unless</td>
                                                               <td>The port will not be used if this property is
                                                                        set</td>
                                                               <td>No</td>
                                                      </tr></tbody>
                                    </informaltable></section>
                           <section>
                                    <title>Parameters specified as nested elements</title>
                                    <para>Either resource collections <emphasis>or</emphasis> a
                                             mapper may be specified, but not both.</para>
                                    <section>
                                             <title>any resource collection</title>
                                             <para>Use resource collections to specify
                                                      fixed resources that should be applied to this
                                                      port.</para>
                                    </section>
                                    <section>
                                             <title>mapper</title>
                                             <para>You can define resources to be used based on the
                                                  resource(s) specified for the <tag
                                                  class="attribute">inport</tag> port or on the
                                                  current resource from the implicit and/or explicit
                                                  input fileset.</para>
                                             <para>You cannot use a mapper on the <tag class="attribute">inport</tag> port.</para>
                                    </section>
                           </section>
                           
                  </section>
                  <section>
                           <title>pipeline</title>
                           <para>Pipeline file.  Can be used instead of <tag class="attribute"
                                             >pipeline</tag>.</para>
                           <section>
                                    <title>Parameters specified as nested elements</title>
                                    <section>
                                             <title>any resource collection</title>
                                             <para>Use resource collections to specify fixed
                                                  resources that should be applied to this
                                                  port.</para>
                                    </section>
                           </section>
                  </section>
                  <section>
                           <title>output</title>
                           <para>Specification of resources to which to write the output from an
                                    output port. May be used as an alternative to <tag
                                             class="attribute">out</tag> to specify to which to
                                    write the output from the <tag class="attribute">outport</tag>
                                    port or may be fixed or mapped resources to be applied to other
                                    ports.</para>
                           <section>
                                    <title>Parameters</title>
                                    <informaltable frame="border">
                                             <thead>
                                                  <tr>
                                                  <th>Attribute</th>
                                                  <th>Description</th>
                                                  <th>Required</th>
                                                  </tr>
                                             </thead>
                                             <tbody>
                                                  <tr>
                                                  <td>port</td>
                                                  <td>port name</td>
                                                  <td>No; the otherwise unmapped output port will be
                                                  used</td>
                                                  </tr>
                                                  <tr>
                                                  <td>if</td>
                                                  <td>The port specification will be used if this
                                                  property is set</td>
                                                  <td>No</td>
                                                  </tr>
                                                  <tr>
                                                  <td>unless</td>
                                                  <td>The port will not be used if this property is
                                                  set</td>
                                                  <td>No</td>
                                                  </tr>
                                             </tbody>
                                    </informaltable>
                           </section>
                           <section>
                                    <title>Parameters specified as nested elements</title>
                                    <para>Either resource collections <emphasis>or</emphasis> a
                                             mapper may be specified, but not both.</para>
                                    <section>
                                             <title>any resource collection</title>
                                             <para>Use resource collections to specify fixed
                                                  resources that should be applied to this
                                                  port.</para>
                                    </section>
                                    <section>
                                             <title>mapper</title>
                                             <para>You can define resources to which to write based
                                                  on the resource(s) specified for the <tag
                                                  class="attribute">inport</tag> port.</para>
                                    </section>
                           </section>
                  </section>
                  <section>
                                    <title>any resource collection</title>
                                    <para>Use resource collections to specify fixed resources that
                                    should processed consecutively in a sequence of Calabash
                                    runs.</para>
                           </section>
                           <section>
                                    <title>mapper</title>
                                    <para>You can define resources to which to write based on the
                                    resource(s) specified for the implicit fileset (based on <tag
                                             class="attribute">includes</tag>, etc.) and/or on the
                                    explicit fileset formed from resource collections that are
                                    children of <tag class="element">calabash</tag>.</para>
                           </section>
                  <section>
                                    <title>namespace</title>
                           <para>Use nested <tag class="element">namespace</tag> elements to define
                                    mappings between prefixes and namespace URIs for any prefixes
                                    that are used in <tag class="element">option</tag> or <tag
                                             class="element">parameter</tag> elements.</para>
                           <informaltable frame="border">
                                    <thead>
                                             <tr>
                                                      <th>Attribute</th>
                                                      <th>Description</th>
                                                      <th>Required</th>
                                             </tr>
                                    </thead>
                                    <tbody>
                                             <tr>
                                                      <td>prefix</td>
                                                  <td>Prefix to which to map the URI</td>
                                                      <td>Yes</td>
                                             </tr>
                                             <tr>
                                                      <td>uri</td>
                                                      <td>Namespace uri</td>
                                                      <td>Yes</td>
                                             </tr>
                                    </tbody>
                           </informaltable></section>
                  <section>
                           <title>option</title>
                           <para>Specifies an option to be passed to the XProc processor</para>
                           <section>
                                    <title>Parameters</title>
                                    <informaltable frame="border">
                                             <thead>
                                                      <tr>
                                                               <th>Attribute</th>
                                                               <th>Description</th>
                                                               <th>Required</th>
                                                      </tr>
                                             </thead>
                                             <tbody>
                                                      <tr>
                                                               <td>name</td>
                                                               <td>Option name, which must be
                                                  unique. QNames have their prefix matched against
                                                  bindings specified in <tag class="element"
                                                  >namespace</tag> elements. QNames may also be
                                                  specified in Clark notation, e.g.,
                                                  <literal>{uri}name</literal>.</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>value</td>
                                                               <td>Option string value</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>if</td>
                                                               <td>The option specification will be used if this
                                                                        property is set</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>unless</td>
                                                               <td>The option will not be used if this property
                                                                        is set</td>
                                                               <td>No</td>
                                                      </tr>
                                             </tbody>
                                    </informaltable>
                           </section>
                  </section>
                  <section>
                           <title>param</title>
                           <para>Specifies a parameter to be passed to the XProc processor</para>
                           <section>
                                    <title>Parameters</title>
                                    <informaltable frame="border">
                                             <thead>
                                                      <tr>
                                                               <th>Attribute</th>
                                                               <th>Description</th>
                                                               <th>Required</th>
                                                      </tr>
                                             </thead>
                                             <tbody>
                                                      <tr>
                                                               <td>port</td>
                                                               <td>Port to which to apply the
                                                  parameter.</td>
                                                               <td>No; default is the primary
                                                  parameter port</td>
                                                      </tr>
                                                      <tr>
                                                               <td>name</td>
                                                               <td>Parameter name name, which must
                                                  be unique. QNames have their prefix matched
                                                  against bindings specified in <tag class="element"
                                                  >namespace</tag> elements. QNames may also be
                                                  specified in Clark notation, e.g.,
                                                  <literal>{uri}name</literal>.</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>value</td>
                                                               <td>Parameter string value</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>if</td>
                                                               <td>The option specification will be used if this
                                                                        property is set</td>
                                                               <td>No</td>
                                                      </tr>
                                                      <tr>
                                                               <td>unless</td>
                                                               <td>The option will not be used if this property
                                                                        is set</td>
                                                               <td>No</td>
                                                      </tr>
                                             </tbody>
                                    </informaltable>
                           </section>
                  </section>
                  <section><title>sysproperty</title>
                           <para>Specify Java system properties used by Calabash</para></section>
                  <section><title>syspropertyset</title>
                           <para>Specify sets of Java system properties used by Calabash</para></section>
         </section>
         <section>
                  <title>Examples</title>
                  <section>
                           <title>Single input, single output</title>
                           <programlisting>&lt;calabash in="in.xml" out="out1.xml" pipeline="pipeline.xpl"/></programlisting>
                           <para>What could be simpler?</para>
                  </section>
                  <section>
                           <title><tag class="element">pipeline</tag></title>
                           <programlisting>&lt;calabash in="in.xml" out="out.xml">
  &lt;pipeline>
    &lt;file file="pipeline.xpl" />
  &lt;/pipeline>
&lt;/calabash></programlisting>
                  </section>
                  <section>
                           <title>Implicit fileset plus mapper on additional input port</title>
                           <programlisting>&lt;calabash includes="doc.xml"
	      inport="source"
	      destdir="out"
	      extension=".compare.xml"
	      pipeline="compare-001.xpl">
      &lt;input port="alternate">
	&lt;globmapper from="*.xml" to="*-alt.xml" />
      &lt;/input>
&lt;/calabash></programlisting>
                  </section>
                  <section>
                           <title>Fixed input, multiple mapped outputs</title>
                           <programlisting>&lt;calabash in="group-003_input1.xml" pipeline="group-003_pipeline.xpl">
      &lt;output port="result">
	&lt;globmapper from="*_input1.xml" to="out/*_result.xml" />
      &lt;/output>
      &lt;output port="result2">
	&lt;globmapper from="*_input1.xml" to="out/*_result2.xml" />
      &lt;/output>
&lt;/calabash></programlisting>
                  </section>
                  <section>
                           <title>QNames</title>
                           <programlisting>&lt;calabash in="in.xml" out="out.xml" pipeline="pipeline.xpl">
      &lt;sysproperty key="com.xmlcalabash.phonehome" value="false" />
      &lt;namespace prefix="hi" uri="low" />
      &lt;parameter name="{hi}there" value="a value" />
      &lt;parameter name="hi:there" value="a value" />
&lt;/calabash></programlisting>
                           <para><literal>{hi}there</literal> is a QName in Clark notation, where
                                             <literal>hi</literal> is the namespace URI and
                                             <literal>there</literal> is the local name; whereas
                                             <literal>hi</literal> in <literal>hi:there</literal> is
                                    a namespace prefix that is bound to the <literal>low</literal>
                                    namespace URI.</para>
                  </section>
         </section>
         <section>
                  <title>What not to do</title>
                  <variablelist>
                           <varlistentry>
                                    <term>Multiple pipelines</term>
                                    <listitem>
                                             <para>Too conflicted</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Non-existent file for <tag class="attribute">in</tag> or
                                                  <tag class="attribute">pipeline</tag> (or <tag
                                                  class="element">pipeline</tag>)</term>
                                    <listitem>
                                             <para>When there's only one of each, it's a problem if
                                                  they don't actually exist</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term><tag class="attribute">in</tag> and/or <tag
                                                  class="attribute">out</tag> and an implicit
                                             fileset</term>
                                    <listitem>
                                             <para>The implicit fileset is ignored (and, when the
                                                  log level is <literal>verbose</literal>, a message
                                                  is emitted)</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Two or more of <tag class="attribute">out</tag>, a
                                             resource for <tag class="attribute">outport</tag>, a
                                             mapper for <tag class="attribute">outport</tag>, and
                                                  <tag class="attribute">extension</tag></term>
                                    <listitem>
                                             <para>Too conflicted</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Duplicate parameter QNames for the same port or duplicate
                                             option QNames</term>
                                    <listitem>
                                             <para>Too conflicted</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Pipeline input port with no explicit binding (or more than
                                             one when one <tag class="element">calabash</tag> input
                                             port is unnamed)</term>
                                    <listitem>
                                             <para>No input is applied to the port.</para>
                                             <para>When one <tag class="element">calabash</tag> port
                                                  is unnamed and more than one pipeline input port
                                                  has no explicit binding, one of the unbound
                                                  pipeline ports is mapped to the unnamed port, but
                                                  you can't control which pipeline port.</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Pipeline output port with no explicit binding (or more
                                             than one when one <tag class="element">calabash</tag>
                                             output port is unnamed)</term>
                                    <listitem>
                                             <para>The pipeline output on that port is
                                                  discarded</para>
                                             <para>When one <tag class="element">calabash</tag>
                                                  output port is unnamed and more than one pipeline
                                                  output port has no explicit binding, one of the
                                                  unbound pipeline ports is mapped to the unnamed
                                                  port, but you can't control which pipeline
                                                  port.</para>
                                    </listitem>
                           </varlistentry><varlistentry>
                                    <term>Resources and mapper on same port</term>
                                    <listitem>
                                             <para>Too conflicted</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Multiple mappers for one port</term>
                                    <listitem>
                                             <para>Too conflicted</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Mapper on main input port</term>
                                    <listitem>
                                             <para>The file(s) on the main input port, determined by
                                                      the <tag class="attribute">inport</tag> value,
                                                      provides the name that other mappers use as their
                                                      basis. A mapper on the main input port has nothing
                                                      to use as a basis, so it's not allowed.</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term>Multiple specifications for an output port or output port
                                             resource collections or mappers that resolve to more
                                             than one filename</term>
                                    <listitem>
                                             <para>The outputs of a pipeline run are each directed
                                                      to at most one file</para>
                                    </listitem>
                           </varlistentry>
                           <varlistentry>
                                    <term><tag class="element">namespace</tag> without <tag
                                             class="attribute">prefix</tag> or without <tag
                                                      class="attribute">uri</tag></term>
                                    <listitem>
                                             <para><tag class="element">namespace</tag> is for
                                                  mapping prefixes to URIs</para>
                                    </listitem>
                           </varlistentry>
                           
                  </variablelist>
         </section>
</chapter>
